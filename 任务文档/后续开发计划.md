# 后续开发任务清单

> 最后更新: 2026-02-07 21:20

根据当前项目完成情况，以下为待办事项按优先级排序：

---

## Phase 1: 核心功能完善 (High Priority)

### 1.1 侧边栏历史记录集成 ✨
**当前状态**: 侧边栏使用静态 mock 数据  
**待完成**:
- [ ] 从 Supabase 加载用户真实项目列表
- [ ] 实现点击历史记录切换到对应项目
- [ ] 实现 "New Chat" 按钮创建新项目并跳转
- [ ] 显示真实的用户信息（用户名、邮箱）
- [ ] 实现退出登录功能
- [ ] 添加项目搜索和筛选功能

**相关文件**: 
- `src/components/layout/sidebar.tsx`
- `src/lib/actions/project.ts`

---

### 1.2 错误处理与用户反馈 ⚠️
- [ ] **AI 生成错误处理**:
  - 添加重试机制（最多3次）
  - 显示友好的错误提示信息
  - 记录错误日志到 Supabase
  
- [ ] **网络错误处理**:
  - 检测网络连接状态
  - 离线状态提示
  - 自动重连机制
  
- [ ] **代码预览错误捕获**:
  - Sandpack 运行时错误展示
  - 控制台错误信息显示
  - 语法错误高亮提示

---

### 1.3 用户体验优化 🎨
- [ ] **Loading 状态优化**:
  - 细化 "Thinking...", "Generating...", "Rendering..." 等状态
  - 添加进度条或骨架屏
  - 优化流式输出的显示效果
  
- [ ] **AI 状态实时反馈** ✨:
  - 增加 "AI 状态" 页签
  - 实时展示 AI 思考与工具调用流
  - 使用 mermaid.js 渲染执行拓扑节点

- [ ] **消息交互增强**:
  - 支持编辑已发送的消息
  - 支持删除消息
  - 支持复制代码块
  - 支持消息点赞/踩
  
- [ ] **快捷键支持**:
  - `Cmd/Ctrl + Enter` 发送消息
  - `Cmd/Ctrl + K` 新建对话
  - `Cmd/Ctrl + B` 切换侧边栏
  - `Cmd/Ctrl + P` 切换预览区

---

## Phase 2: 功能增强 (Medium Priority)

### 2.1 多文件支持 📁
**当前限制**: Sandpack 主要支持单文件或预设模板  
**扩展方案**:
- [ ] 支持创建多个文件（如 `index.js`, `styles.css`, `utils.js`）
- [ ] 文件树导航器
- [ ] 文件间依赖关系管理
- [ ] 支持导入外部 npm 包

---

### 2.2 代码编辑器增强 ✏️
- [ ] **编辑器功能**:
  - 代码高亮和语法检查
  - 自动补全
  - 格式化代码 (Prettier)
  - 支持暗色/亮色主题切换
  
- [ ] **版本控制**:
  - 代码历史记录（类似 Git 提交）
  - 支持回滚到历史版本
  - 对比不同版本差异

---

### 2.3 分享与协作 🔗
- [x] **公开分享功能** (已完成)
  - 生成唯一分享链接
  - 只读预览页面
  
- [ ] **协作功能** (扩展):
  - 支持评论系统
  - 支持 Fork 他人项目
  - 项目标签和分类
  - 热门项目推荐页面

---

## Phase 3: 性能与质量 (Low Priority)

### 3.1 性能优化 ⚡
- [ ] **代码加载优化**:
  - 大型代码文件懒加载
  - 虚拟滚动（对于长历史记录）
  
- [ ] **聊天历史优化**:
  - 分页加载消息（每次20条）
  - 无限滚动加载
  - 消息缓存策略
  
- [ ] **构建优化**:
  - 代码分割 (Code Splitting)
  - 图片和资源压缩
  - CDN 部署静态资源

---

### 3.2 测试与文档 📝
- [ ] **单元测试**:
  - Server Actions 测试
  - API Routes 测试
  - 组件测试 (React Testing Library)
  
- [ ] **E2E 测试**:
  - Playwright 或 Cypress
  - 关键用户流程覆盖
  
- [ ] **文档完善**:
  - 用户使用指南
  - 开发者文档
  - API 接口文档更新

---

## Phase 4: 高级功能 (Future)

### 4.0 全栈与交互集成 (New)
- [ ] **前后端连通**: 实现 Reverse Proxy，让前端预览能访问后端容器。
- [ ] **Opencode 集成**:
  - [ ] Docker 镜像集成 Python/Node 解释器 agent。
  - [ ] IDE 界面集成 Terminal/Console。
  - [ ] 实现自然语言控制容器内代码执行。

### 4.1 AI 能力提升 🤖
- [ ] 支持选择不同的 AI 模型
- [ ] 支持多轮对话上下文优化
- [ ] 支持图片输入（生成 UI 设计）
- [ ] AI 代码审查和优化建议

### 4.2 部署与集成 🚀
- [ ] 一键部署到 Vercel/Netlify
- [ ] GitHub 集成（导出为 GitHub Repo）
- [ ] 支持自定义域名
- [ ] WebContainer 集成（本地运行环境）

---

## 优先级建议

**本周重点**: 
1. ✨ 侧边栏历史记录集成 (1.1)
2. ⚠️ 错误处理与用户反馈 (1.2)

**下周计划**:
3. 🎨 用户体验优化 (1.3)
4. 📁 多文件支持 (2.1)
